<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

  <title>Deep Height Decoupling for Precise Vision-based 3D Occupancy Prediction</title>
  
  <meta name="author" content="Zhengxue Wang">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" type="text/css" href="projects.css">
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
  <link rel="icon" type="image/png" href="logo.png">
</head>

<body style="width: 100%;">
    <div style="width: 100%;">
        <!-- Title -->
        <div class="root-content" style="padding-top: 30px;">
            <name>Deep Height Decoupling for Precise Vision-based 3D Occupancy Prediction</name>
            <br>
            <div id="author-list">
                Yuan Wu</a><sup>1&ast;</sup>&nbsp;&nbsp;&nbsp;
                <a href="https://yanzq95.github.io/">Zhiqiang Yan</a><sup>1&ast;&dagger;	</sup>&nbsp;&nbsp;&nbsp;
				<a href="https://scholar.google.com/citations?user=VogTuQkAAAAJ&hl=zh-CN">Zhengxue Wang</a><sup>1</sup>&nbsp;&nbsp;&nbsp;
				<a href="https://implus.github.io/">Xiang Li</a><sup>2</sup>&nbsp;&nbsp;&nbsp;
				<a href="https://fpthink.github.io/">Le Hui</a><sup>3</sup>&nbsp;&nbsp;&nbsp;
				<a href="https://scholar.google.com/citations?user=6CIDtZQAAAAJ&hl=zh-CN">Jian Yang</a><sup>1&dagger;</sup>&nbsp;&nbsp;&nbsp;
            </div>
            <div id="institution-list">
				<sup>&ast;</sup>equal contribution&nbsp;&nbsp;&nbsp;
				<sup>&dagger;</sup>corresponding author&nbsp;&nbsp;&nbsp;<br>
                <sup>1</sup>Nanjing University of Science and Technology&nbsp;&nbsp;&nbsp;
				<sup>2</sup>Nankai University&nbsp;&nbsp;&nbsp;
				<sup>3</sup>Northwestern Polytechnical University&nbsp;&nbsp;&nbsp;
            </div>

            <div id="button-list">
                <span class="link-button">
                    <a class="link-button-content", href="https://arxiv.org/pdf/2409.07972", target="_blank">
                        <span>
                            <svg class="svg-inline--fa fa-file-pdf fa-w-12" style="position: relative; top: 0.15em;" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="file-pdf" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"></path></svg>
                        </span>
                        &nbsp;
                        Paper
                    </a>
                </span>
                <span class="link-button">
                    <a class="link-button-content" href="https://github.com/yanzq95/DHD", target="_blank">
                        <span>
                            <svg class="svg-inline--fa fa-file-pdf" aria-hidden="true" version="1.1" viewBox="0 0 16 16" width="1.2em" style="position: relative; top: 0.25em;"><path fill="currentColor" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
                        </span>
                        &nbsp; 
                        Code
                    </a>
                </span>
                <span class="link-button">
                    <a class="link-button-content", href="#bib">
                        <span>
                            <svg class="svg-inline--fa fa-file-pdf" aria-hidden="true" style="position: relative; top: 0.15em;" width="1em" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bookmarks" viewBox="0 0 16 16"> <path fill="currentColor" fill-rule="evenodd" d="M2 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v11.5a.5.5 0 0 1-.777.416L7 13.101l-4.223 2.815A.5.5 0 0 1 2 15.5V4zm2-1a1 1 0 0 0-1 1v10.566l3.723-2.482a.5.5 0 0 1 .554 0L11 14.566V4a1 1 0 0 0-1-1H4z" fill="white"></path> <path fill="currentColor" fill-rule="evenodd" d="M4.268 1H12a1 1 0 0 1 1 1v11.768l.223.148A.5.5 0 0 0 14 13.5V2a2 2 0 0 0-2-2H6a2 2 0 0 0-1.732 1z" fill="white"></path> </svg>
                        </span>
                        &nbsp;  
                        BibTex
                    </a>
                </span>
            </div>
        </div>




        <div style="background-color: #f5f5f5; margin-right: auto; margin-left: auto;">
            <div class="root-content" style="padding-top: 10px;">
                <h1 class="section-name">&#128293; Amazing Vision-Based Occupancy Prediction Model &#128293;</h1>
                <p class="section-content-text">
                    <!--Our SPFNet achieves prominent super-resolution performance benefits from <strong>All-in-one Prior Propagation</strong>, <strong>One-to-One Prior Embedding</strong>, and <strong>Mutual Guided Filter</strong>. -->
					For the first time, DHD incorporates the height prior into the model through explicit height supervision, ameliorating the problem of feature confusion in the 2D-to-3D view transformation.



        <div style="text-align: center;">
          <video controls width="1000" height="auto" style="display: block; margin: 0 auto;">
            <source src="vis_video.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>




        <!-- Paper Information -->
        <div class="root-content" style="padding-top: 30px;">
            <div class="section-content">
            <h1 class="section-name"> Abstract </h1>
                <p class="section-content-text">
The task of vision-based 3D occupancy prediction aims to reconstruct 3D geometry and estimate its semantic classes from 2D color images, where the 2D-to-3D view transformation is an indispensable step. Most previous methods conduct forward projection, such as BEVPooling and VoxelPooling, both of which map the 2D image features into 3D grids. However, the current grid representing features within a certain height range usually introduces many confusing features that belong to other height ranges. To address this challenge, we present Deep Height Decoupling (DHD), a novel framework that incorporates explicit height prior to filter out the confusing features. Specifically, DHD first predicts height maps via explicit supervision. Based on the height distribution statistics, DHD designs Mask Guided Height Sampling (MGHS) to adaptively decouple the height map into multiple binary masks. MGHS projects the 2D image features into multiple subspaces, where each grid contains features within reasonable height ranges. Finally, a Synergistic Feature Aggregation (SFA) module is deployed to enhance the feature representation through channel and spatial affinities, enabling further occupancy refinement. On the popular Occ3D-nuScenes benchmark, our method achieves state-of-the-art performance even with minimal input frames. Code is available at https://github.com/yanzq95/DHD.
                </p>
            </div>

            <div style="padding-top: 20px;">
                <h1 class="section-name">Method</h1>
                <img src="Overview.png" width="1000"/>
                <p class="section-content-text">
                    <strong>DHD.</strong> The feature extractor first acquires 2D image feature Fimg. Then, DepthNet extracts context feature F<sub>ctx</sub> and depth prediction D. HeightNet generates the height map Hmap to determine the height value at each pixel. Next, MGHS integrates D, F<sub>ctx</sub>, and Hmap for feature projection. Specifically, it decouples H<sub>map</sub> to produce height masks Hmask, which are utilized to filter the height-aware feature Fha from F<sub>ctx</sub>. F<sub>ha</sub> is projected into multiple subspaces to obtain height-refined feature Fhr. Besides it employs BEVPooling to encode F<sub>ctx</sub> into depth-based feature Fdb. Finally, both F<sub>hr</sub> and F<sub>db</sub> are fed into the SFA to obtain the aggregated feature F<sub>agg</sub>, which serves as input for the predictor.
                </p>
				<img src="line.png" width="700"/><br><br>
				<img src="MGHS.png" width="1000"/>
                <p class="section-content-text">
                   <strong>Mask guided height sampling (MGHS).</strong>  MGHS consists of two core processes: height decoupling (a) and mask projection (b). In (a), we decouple height into three subspaces based on height distribution statistics. In (b), the height mask is utilized to filter out redundant feature points, enabling precise 2D-to-3D view transformation.
                </p>
	      <img src="line.png" width="700"/><br><br>
				<img src="mix.png" width="500"/>
                <p class="section-content-text">
                   <strong>Synergistic Feature Aggregation (SFA).</strong> The two-stage SFA is introduced to enhance the feature representation using channel and spatial affinities.
                </p>
            </div>

            <div style="padding-top: 20px;">
                <h1 class="section-name">
                    Quantitative Comparison
                </h1>
                <img src="table.png" width="1000"/>
            </div>

            <div style="padding-top: 20px;">
                <h1 class="section-name">
                    Visual Comparison
                </h1>
                <img src="vis.png" width="1000"/>
				<p align="center">

                </p><br>
                <!-- <img src="result2.png" width="998" style="margin-top: -4px;"/> -->
            </div>

            <div>
                <h1 class="section-name" style="margin-top: 30px; text-align: left; font-size: 25px;">
                    BibTex
                </h1>
                <a name="bib"></a>
                <pre style="margin-top: 5px;" class="bibtex">
                    <code>
@article{wu2024deep,
  title={Deep Height Decoupling for Precise Vision-based 3D Occupancy Prediction},
  author={Wu, Yuan and Yan, Zhiqiang and Wang, Zhengxue and Li, Xiang and Hui, Le and Yang, Jian},
  journal={arXiv preprint arXiv:2409.07972},
  year={2024}
}
</code></pre>
            </div>
            <div style="margin-bottom: 50px;">
                <h1 class="section-name" style="margin-top: 30px; margin-bottom: 10px; text-align: left; font-size: 25px;">
                    Contact
                </h1>
                <p class="section-content-text">
                    For any questions, please contact <strong>{wuyuan,yanzq}@njust.edu.cn</strong>
                </p>
            </div>
        </div>


        <!-- <div style="background-color: #f5f5f5; margin-right: auto; margin-left: auto; text-align: center; padding-top: 35px; padding-bottom: 35px;">
            <a href="https://www.freecounterstat.com" title="web page counter"><img src="https://counter4.optistats.ovh/private/freecounterstat.php?c=xdafgsksdt68ssg1n7kfmr61ul4ugbb6" border="0" title="web page counter" alt="web page counter"></a>
            <p>Visitor Count</p>
        </div> -->
        <div style="background-color: #f5f5f5; margin-right: auto; margin-left: auto; text-align: center; padding-top: 35px; padding-bottom: 35px;">
            <p><font face="Arial"> &copy; Zhengxue Wang, Zhiqiang Yan | Last updated: Sep. 2024</font></p>
        </div>
    </div>
</body>



<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$']]},
        messageStyle: "none"
    });
</script>



<!-- juxtapose_images -->
<script src="https://cdn.knightlab.com/libs/juxtapose/latest/js/juxtapose.min.js"></script>
<link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css">

<script>
    slider = new juxtapose.JXSlider('#jt1',
        [
            {src: 'juxtapose_images/Lu_1_left.png'},
            {src: 'juxtapose_images/Lu_1_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt2',
        [
            {src: 'juxtapose_images/Lu_2_left.png'},
            {src: 'juxtapose_images/Lu_2_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt3',
        [
            {src: 'juxtapose_images/Midd_1_left.png'},
            {src: 'juxtapose_images/Midd_1_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt4',
        [
            {src: 'juxtapose_images/Midd_2_left.png'},
            {src: 'juxtapose_images/Midd_2_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt5',
        [
            {src: 'juxtapose_images/NYU_1_left.png'},
            {src: 'juxtapose_images/NYU_1_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt6',
        [
            {src: 'juxtapose_images/NYU_2_left.png'},
            {src: 'juxtapose_images/NYU_2_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt7',
        [
            {src: 'juxtapose_images/RGBDD_1_left.png'},
            {src: 'juxtapose_images/RGBDD_1_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
<script>
    slider = new juxtapose.JXSlider('#jt8',
        [
            {src: 'juxtapose_images/RGBDD_2_left.png'},
            {src: 'juxtapose_images/RGBDD_2_right.png'}
        ],
        {
            animate: true,
            showLabels: false,
            showCredits: false,
            startingPosition: "50%",
            makeResponsive: true
        });
</script>
